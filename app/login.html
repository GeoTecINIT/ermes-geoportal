<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Ermes Movile APP</title>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
</head>
<body>
<div class="container" style="background-image: url(img/loginBackground.jpg); height: 580px; width: 1600px;">
<br><br><br>
    <div class="col-md-4 col-md-offset-3">
        <div class="panel panel-success center-block" >
            <div class="panel-heading">
                <h3 class="text-center">Log In</h3>
            </div>
            <div class="panel-body">
                <form class="form-horizontal" id="loginForm" >
                    <section class="container">
                        <div class="form-group" >
                            <div class="col-md-4">
                                <input type="text" name="username" class="form-control" placeholder="Username" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-4">
                                <input type="password" name="password" class="form-control" placeholder="Password" required>
                            </div>
                        </div>
                        <div>
                        <button type="submit" class="btn btn-default">Submit</button>
                        <!--<a href="register.html">Create account.</a>-->
                        </div>
                        <div>
                            <p id="response" class="text-danger"></p>
                        </div>
                    </section>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Handle the submit programatically.
    $( "#loginForm" ).submit(function( event ) {

        // Stop usuarl submit
        event.preventDefault();

        // Get values and variables:
        var $form = $( this ),
                username = $form.find( "input[name='username']" ).val(),
                password = $form.find( "input[name='password']" ).val(),
                url = "http://ermes.dlsi.uji.es:6585/login";
        // Make the POST
        var posting = $.post(url, {username: username, password: password});

        // Show results asynchronously.
        posting.done(function (data) {
            console.log(data);
            if(!data)
                $("#response").text("User or Password Wrong.");
            else {
                document.cookie="username=" + data.user;
                document.cookie="region=" + data.region;
                document.cookie="profile=" + data.profile;
                document.cookie="password=" + password;
                window.location.replace("./index.html");
            }
        });
    });

</script>
</body>
</html>
